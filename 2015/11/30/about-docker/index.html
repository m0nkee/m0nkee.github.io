
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>about-docker | Monkee</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Monkee Lei">
    

    
    <meta name="description" content="Docker简介Docker可以解决虚拟机能够解决的问题，同时也能够解决虚拟机由于资源要求过高而无法解决的问题。Docker能处理的事情包括：


隔离应用依赖
创建应用镜像并进行复制
创建容易分发的即启即用的应用
允许实例简单、快速地扩展
测试应用并随后销毁它们


Docker三大核心概念


镜像 image ：类似于虚拟机的快照，但更轻量。
容器 container ：镜像的一个运行实例，">
<meta property="og:type" content="article">
<meta property="og:title" content="about-docker">
<meta property="og:url" content="http://m0nkee.github.io/2015/11/30/about-docker/index.html">
<meta property="og:site_name" content="Monkee">
<meta property="og:description" content="Docker简介Docker可以解决虚拟机能够解决的问题，同时也能够解决虚拟机由于资源要求过高而无法解决的问题。Docker能处理的事情包括：


隔离应用依赖
创建应用镜像并进行复制
创建容易分发的即启即用的应用
允许实例简单、快速地扩展
测试应用并随后销毁它们


Docker三大核心概念


镜像 image ：类似于虚拟机的快照，但更轻量。
容器 container ：镜像的一个运行实例，">
<meta property="og:image" content="http://wenku.baidu.com/content/d817967416fc700abb68fca1?m=53edf76e3be441c342485c83deb30a3d&type=pic&src=766c4dab3fb9cf4d1b93c27911a87fcd.png">
<meta property="og:updated_time" content="2015-11-30T07:53:19.208Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="about-docker">
<meta name="twitter:description" content="Docker简介Docker可以解决虚拟机能够解决的问题，同时也能够解决虚拟机由于资源要求过高而无法解决的问题。Docker能处理的事情包括：


隔离应用依赖
创建应用镜像并进行复制
创建容易分发的即启即用的应用
允许实例简单、快速地扩展
测试应用并随后销毁它们


Docker三大核心概念


镜像 image ：类似于虚拟机的快照，但更轻量。
容器 container ：镜像的一个运行实例，">
<meta name="twitter:creator" content="@monkee_lei">

    
    <link rel="alternative" href="/atom.xml" title="Monkee" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/monkee.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/monkee.png" alt="Monkee" title="Monkee"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Monkee">Monkee</a></h1>
				<h2 class="blog-motto">Stay Hungry Stay Foolish</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页|Home</a></li>
					
						<li><a href="/archives">归档|Archives</a></li>
					
						<li><a href="/about">关于|About</a></li>
					
					<li>
 					
						<form class="search">
							<label>Search</label>
						<input type="text" id="ts-search-input" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/11/30/about-docker/" title="about-docker" itemprop="url">about-docker</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Monkee Lei" target="_blank" itemprop="author">Monkee Lei</a>
		
  <p class="article-time">
    <time datetime="2015-11-30T07:50:41.000Z" itemprop="datePublished"> 发表于 2015-11-30</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker简介"><span class="toc-number">1.</span> <span class="toc-text">Docker简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker安装"><span class="toc-number">2.</span> <span class="toc-text">Docker安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#镜像"><span class="toc-number">3.</span> <span class="toc-text">镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#容器"><span class="toc-number">4.</span> <span class="toc-text">容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#仓库"><span class="toc-number">5.</span> <span class="toc-text">仓库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据"><span class="toc-number">6.</span> <span class="toc-text">数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷"><span class="toc-number">6.1.</span> <span class="toc-text">数据卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷容器"><span class="toc-number">6.2.</span> <span class="toc-text">数据卷容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#备份和恢复"><span class="toc-number">6.3.</span> <span class="toc-text">备份和恢复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网络"><span class="toc-number">7.</span> <span class="toc-text">网络</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">8.</span> <span class="toc-text">参考</span></a></li></ol>
		
		</div>
		
		<h2 id="Docker简介">Docker简介</h2><p>Docker可以解决虚拟机能够解决的问题，同时也能够解决虚拟机由于资源要求过高而无法解决的问题。Docker能处理的事情包括：</p>
<blockquote>
<ul>
<li>隔离应用依赖</li>
<li>创建应用镜像并进行复制</li>
<li>创建容易分发的即启即用的应用</li>
<li>允许实例简单、快速地扩展</li>
<li>测试应用并随后销毁它们</li>
</ul>
</blockquote>
<p>Docker三大核心概念</p>
<blockquote>
<ul>
<li>镜像 image ：类似于虚拟机的快照，但更轻量。</li>
<li>容器 container ：镜像的一个运行实例，可以独立运行一个或一组应用。</li>
<li>仓库 repository ：集中存放镜像的地方</li>
</ul>
</blockquote>
<h2 id="Docker安装">Docker安装</h2><blockquote>
<p>OS：Ubuntu 14.04  #<strong><em>主要docker 默认为64位系统，32位会出现问题</em></strong></p>
</blockquote>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">要求kernel &gt;= <span class="number">3.8</span>，若不满足执行下面操作</span><br><span class="line"><span class="preprocessor">#安装内核</span></span><br><span class="line">sudo apt-<span class="keyword">get</span> update</span><br><span class="line">sudo apt-<span class="keyword">get</span> install linux-image-generic-lts-raring linux-headers-generic-lts-raring</span><br><span class="line"><span class="preprocessor">#重启</span></span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>
<ol>
<li><p>添加docker的repository到本地密钥库</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys <span class="number">36A1D78692</span><span class="number">45C8950F96</span><span class="number">6E92D8576</span>A8BA88D21E9</span><br></pre></td></tr></table></figure>
</li>
<li><p>将Docker添加到你的apt软件安装源中，然后update和install lxc-docker</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="keyword">sh</span> -<span class="keyword">c</span> <span class="string">"echo deb http://get.docker.io/ubuntu docker main &gt; /etc/apt/sources.list.d/docker.list"</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> install lxc-docker</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="镜像">镜像</h2><ul>
<li><p>获取镜像</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">sudo docker pull ubuntu [TAG]</span><br><span class="line"><span class="preprocessor">#TAG:<span class="number">14.04</span> 表示特定版本， 默认下载最新版本</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#eg:</span></span><br><span class="line">monkee@ubuntu:~$ sudo docker pull ubuntu</span><br><span class="line">Using <span class="keyword">default</span> tag: latest</span><br><span class="line">latest: Pulling from library/ubuntu</span><br><span class="line"><span class="number">0</span>a85502c06c9: Pull complete </span><br><span class="line"><span class="number">0998</span>bf8fb9e9: Pull complete </span><br><span class="line">a6785352b25c: Pull complete </span><br><span class="line">e9ae3c220b23: Pull complete </span><br><span class="line">Digest: sha256:f91f9bab1fe6d0db0bfecc751d127a29d36e85483b1c68e69a246cf1df9b4251</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> ubuntu:latest</span><br><span class="line">monkee@ubuntu:~$ sudo docker pull ubuntu:<span class="number">14.04</span></span><br><span class="line"><span class="number">14.04</span>: Pulling from library/ubuntu</span><br><span class="line">Digest: sha256:<span class="number">28</span>bd2edcebe82d41c3494bf6205016fe08e681452f1448acd44d55e2cda7e3c0</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> ubuntu:<span class="number">14.04</span></span><br><span class="line">monkee@ubuntu:~$ sudo docker pull ubuntu:<span class="number">13.04</span></span><br><span class="line"><span class="number">13.04</span>: Pulling from library/ubuntu</span><br><span class="line">d634beec75db: Pull complete </span><br><span class="line">acc11bd60981: Pull complete </span><br><span class="line"><span class="number">307e4</span>bfe3398: Pull complete </span><br><span class="line"><span class="number">2</span>dd5ccb60cc5: Pull complete </span><br><span class="line">e754e00b59af: Pull complete </span><br><span class="line">Digest: sha256:bc48dd7075ce920ebbaa4581d3200e9fb3aaec31591061d7e3a280a04ef0248c</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> ubuntu:<span class="number">13.04</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用镜像创建一个容器</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -t -<span class="tag">i</span> ubuntu /bin/bash</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看镜像信息</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo docker images</span><br><span class="line"><span class="preprocessor">#添加新标签</span></span><br><span class="line">sudo docker tag [OLD_REPOSITORY]:[OLD_TAG] [NEW_REPOSITORY]:[NEW_TAG]</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#eg.</span></span><br><span class="line">monkee@ubuntu:~$ sudo docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span><br><span class="line">ubuntu              <span class="number">14.04</span>               e9ae3c220b23        <span class="number">2</span> weeks ago         <span class="number">187.9</span> MB</span><br><span class="line">ubuntu              latest              e9ae3c220b23        <span class="number">2</span> weeks ago         <span class="number">187.9</span> MB</span><br><span class="line">ubuntu              <span class="number">13.04</span>               e754e00b59af        <span class="number">17</span> months ago       <span class="number">169.4</span> MB</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>镜像拥有唯一ID，以及一个供人阅读的名字和标签对。镜像可以命名为类似ubuntu:latest、ubuntu:14.04等。<br>image id相同说明标签指向了同一个镜像文件。</p>
</blockquote>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">sudo docker inspect [image id] <span class="preprocessor">#获取镜像的详细信息</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#eg.</span></span><br><span class="line">monkee<span class="constant">@ubuntu</span>:~$ sudo docker inspect e9ae3c220b23</span><br><span class="line">[</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"Id"</span>: <span class="string">"e9ae3c220b23b699cb5e6914af806219b028c78d5cf6fed8eeca98ffaa8c9b43"</span>,</span><br><span class="line">    <span class="string">"RepoTags"</span>: [</span><br><span class="line">        <span class="string">"ubuntu:14.04"</span>,</span><br><span class="line">        <span class="string">"ubuntu:latest"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"RepoDigests"</span>: [],</span><br><span class="line">    <span class="string">"Parent"</span>: <span class="string">"a6785352b25c7398637e5ab5a6e989b8371f5dfdf72d9a6cdb00742f262a223e"</span>,</span><br><span class="line">    <span class="string">"Comment"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"Created"</span>: <span class="string">"2015-11-10T00:35:07.49709192Z"</span>,</span><br><span class="line">    <span class="string">"Container"</span>: <span class="string">"84382e3b0cae0e65ad88f32aee022f08bd2b88ba703b3b52b2f5af6bafdedc62"</span>,</span><br><span class="line">    <span class="string">"ContainerConfig"</span>: &#123;</span><br><span class="line">        <span class="string">"Hostname"</span>: <span class="string">"a52c17016130"</span>,</span><br><span class="line">        <span class="string">"Domainname"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"User"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"AttachStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"AttachStdout"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"AttachStderr"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"Tty"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"OpenStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"StdinOnce"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"Env"</span>: [],</span><br><span class="line">        <span class="string">"Cmd"</span>: [</span><br><span class="line">            <span class="string">"/bin/sh"</span>,</span><br><span class="line">            <span class="string">"-c"</span>,</span><br><span class="line">            <span class="string">"#(nop) CMD [\"</span>/bin/bash\<span class="string">"]"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"Image"</span>: <span class="string">"a467a7c6794fd7ebd5bd0e2dcb83a656ac8302e549c4a2cc29c524aea5c5623b"</span>,</span><br><span class="line">        <span class="string">"Volumes"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"WorkingDir"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Entrypoint"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"OnBuild"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"Labels"</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"DockerVersion"</span>: <span class="string">"1.9.0"</span>,</span><br><span class="line">    <span class="string">"Author"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"Config"</span>: &#123;</span><br><span class="line">        <span class="string">"Hostname"</span>: <span class="string">"a52c17016130"</span>,</span><br><span class="line">        <span class="string">"Domainname"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"User"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"AttachStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"AttachStdout"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"AttachStderr"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"Tty"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"OpenStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"StdinOnce"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"Env"</span>: [],</span><br><span class="line">        <span class="string">"Cmd"</span>: [</span><br><span class="line">            <span class="string">"/bin/bash"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"Image"</span>: <span class="string">"a467a7c6794fd7ebd5bd0e2dcb83a656ac8302e549c4a2cc29c524aea5c5623b"</span>,</span><br><span class="line">        <span class="string">"Volumes"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"WorkingDir"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Entrypoint"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"OnBuild"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"Labels"</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"Architecture"</span>: <span class="string">"amd64"</span>,</span><br><span class="line">    <span class="string">"Os"</span>: <span class="string">"linux"</span>,</span><br><span class="line">    <span class="string">"Size"</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">"VirtualSize"</span>: <span class="number">187919300</span>,</span><br><span class="line">    <span class="string">"GraphDriver"</span>: &#123;</span><br><span class="line">        <span class="string">"Name"</span>: <span class="string">"aufs"</span>,</span><br><span class="line">        <span class="string">"Data"</span>: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<ul>
<li><p>搜索镜像</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#搜索带关键字的镜像</span></span><br><span class="line">sudo docker search KEYWORDS</span><br><span class="line"></span><br><span class="line"><span class="comment">#eg.</span></span><br><span class="line">monkee@ubuntu:~$ sudo docker search docker</span><br><span class="line">NAME                                    DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">jenkins                                 Official Jenkins Docker image                   <span class="number">837</span>       [OK]       </span><br><span class="line">registry                                Containerized docker registry                   <span class="number">499</span>       [OK]       </span><br><span class="line">alpine                                  A minimal Docker image based <span class="command"><span class="keyword">on</span> <span class="title">Alpine</span> <span class="title">Lin</span>...   <span class="title">346</span>       [<span class="title">OK</span>]       </span></span><br><span class="line">fedora                                  Official Docker builds <span class="operator">of</span> Fedora                <span class="number">251</span>       [OK]       </span><br><span class="line">swarm                                   Swarm: <span class="operator">a</span> Docker-native clustering <span class="keyword">system</span>.       <span class="number">87</span>        [OK]       </span><br><span class="line">dockerui/dockerui                       A web interface <span class="built_in">to</span> interact <span class="operator">with</span> <span class="operator">the</span> Docke...   <span class="number">71</span>                   [OK]</span><br><span class="line">konradkleine/docker-registry-frontend   Browse <span class="operator">and</span> modify your Docker registry <span class="operator">in</span> ...   <span class="number">56</span>                   [OK]</span><br><span class="line">jdubois/jhipster-docker                 Official JHipster Docker image, <span class="keyword">by</span> <span class="operator">the</span> JHi...   <span class="number">44</span>                   [OK]</span><br><span class="line">docker                                  Docker <span class="operator">in</span> Docker!                               <span class="number">41</span>        [OK]       </span><br><span class="line">docker-dev                              Docker is <span class="operator">an</span> <span class="built_in">open</span> source project <span class="built_in">to</span> pack, ...   <span class="number">36</span>        [OK]       </span><br><span class="line">hello-world                             Hello World! (<span class="operator">an</span> example <span class="operator">of</span> minimal Docker...   <span class="number">30</span>        [OK]       </span><br><span class="line">martin/docker-cleanup-volumes           Delete orphaned docker volumes                  <span class="number">24</span>                   [OK]</span><br><span class="line">devalx/docker-teamspeak3                Docker Container <span class="operator">with</span> Teamspeak <span class="number">3.</span> Contain...   <span class="number">16</span>                   [OK]</span><br><span class="line">twiecki/pydata-docker-jupyterhub        PyData multi-user IPython/Jupyter notebook...   <span class="number">15</span>                   [OK]</span><br><span class="line">datadog/docker-dd-agent                 Docker container <span class="keyword">for</span> <span class="operator">the</span> Datadog Agent.         <span class="number">15</span>                   [OK]</span><br><span class="line">grahamdumpleton/<span class="operator">mod</span>-wsgi-docker         Docker images <span class="keyword">for</span> Apache/mod_wsgi.              <span class="number">13</span>                   [OK]</span><br><span class="line">spotify/docker-gc                       Garbage collection <span class="operator">of</span> Docker containers <span class="operator">an</span>...   <span class="number">10</span>                   [OK]</span><br><span class="line">dockercore/docker                                                                       <span class="number">5</span>                    [OK]</span><br><span class="line">cgal/testsuite-docker                   Docker images <span class="keyword">for</span> <span class="operator">the</span> CGAL testsuite            <span class="number">2</span>                    [OK]</span><br><span class="line">dockerimages/docker-tools                                                               <span class="number">1</span>                    [OK]</span><br><span class="line">docker/migrator                         Tool <span class="built_in">to</span> migrate Docker images <span class="built_in">from</span> <span class="operator">a</span> v1 re...   <span class="number">1</span>                    [OK]</span><br><span class="line">sematext/spm-agent-docker               Performance Monitoring, Events <span class="operator">and</span> Logs fo...   <span class="number">1</span>                    [OK]</span><br><span class="line">docker/docker-bench-security            Docker Bench checks <span class="keyword">for</span> dozens <span class="operator">of</span> common b...   <span class="number">1</span>                    [OK]</span><br><span class="line">piefke3000/helma-docker                 Dockerizing <span class="operator">the</span> old <span class="operator">and</span> wise odd-toed ungu...   <span class="number">1</span>                    [OK]</span><br><span class="line">pylam/docker                            Build Fedora docker container                   <span class="number">0</span>                    [OK]</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除镜像</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker rmi [TAG <span class="string">| IMAGE ID]</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>注意</strong></p>
<blockquote>
<p>删除镜像前先要删除依赖该镜像的所有容器。</p>
</blockquote>
<ul>
<li>创建镜像<br>三种方法：基于已有镜像的容器创建、基于本地模板导入、基于Dockerfile创建</li>
</ul>
<p>1）基于已有镜像的容器创建<br>首先启动一个镜像，并进行修改<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker run -t -i  <span class="symbol">ubuntu:</span><span class="number">14.04</span> /bin/bash</span><br><span class="line">root<span class="variable">@3b776d7e84c3</span><span class="symbol">:/</span><span class="comment"># touch test </span></span><br><span class="line">root<span class="variable">@3b776d7e84c3</span><span class="symbol">:/</span><span class="comment"># echo "this is a test :)" &gt; test</span></span><br><span class="line">root<span class="variable">@3b776d7e84c3</span><span class="symbol">:/</span><span class="comment"># exit</span></span><br><span class="line">exit</span><br></pre></td></tr></table></figure></p>
<p>容器ID为：3b776d7e84c3</p>
<p>现在可以创建一个新的镜像了<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">monkee@ubuntu:~$ sudo docker <span class="operator"><span class="keyword">commit</span> -<span class="keyword">m</span> <span class="string">"add a test file"</span> -a <span class="string">"Docker test"</span> <span class="number">3</span>b776d7e84c3 <span class="keyword">test</span></span><br><span class="line"><span class="number">879</span>f386d63fcf1c7b7a9c5550970bf4cc06b66241a3f61d3ce4dae24b49ae86b   #返回新创建镜像的<span class="keyword">ID</span>信息</span><br><span class="line">monkee@ubuntu:~$ sudo docker images  #查看新创建的镜像</span><br><span class="line">REPOSITORY          TAG                 IMAGE <span class="keyword">ID</span>            CREATED             <span class="keyword">VIRTUAL</span> <span class="keyword">SIZE</span></span><br><span class="line"><span class="keyword">test</span>                latest              <span class="number">879</span>f386d63fc        <span class="number">2</span> minutes ago       <span class="number">187.9</span> MB</span><br><span class="line">ubuntu              <span class="number">14.04</span>               e9ae3c220b23        <span class="number">2</span> weeks ago         <span class="number">187.9</span> MB</span><br><span class="line">ubuntu              latest              e9ae3c220b23        <span class="number">2</span> weeks ago         <span class="number">187.9</span> MB</span><br><span class="line">ubuntu              <span class="number">13.04</span>               e754e00b59af        <span class="number">17</span> <span class="keyword">months</span> ago       <span class="number">169.4</span> MB</span><br><span class="line"></span><br><span class="line">monkee@ubuntu:~$ sudo docker run -<span class="keyword">t</span> -<span class="keyword">i</span>  <span class="keyword">test</span>:latest /<span class="keyword">bin</span>/bash</span><br><span class="line">root@f57c9ec148db:/# ls</span><br><span class="line"><span class="keyword">bin</span>   dev  home  lib64  mnt  proc  run   srv  <span class="keyword">test</span>  usr</span><br><span class="line">boot  etc  lib   media  opt  root  sbin  <span class="keyword">sys</span>  tmp   <span class="keyword">var</span></span><br><span class="line">root@f57c9ec148db:/# cat <span class="keyword">test</span></span><br><span class="line">this <span class="keyword">is</span> a <span class="keyword">test</span> :)</span></span><br></pre></td></tr></table></figure></p>
<p>2）基于本地模板创建<br>首先，从OpenVZ下载模板<a href="https://download.openvz.org/template/precreated/" target="_blank" rel="external">here</a>。</p>
<p>然后，解压倒入方可<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cat ubuntu-<span class="number">15.04</span>-x86_64-minimal.tar.gz | docker import - ubuntu:<span class="number">15.04</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>存出和载入镜像<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#存出镜像</span></span><br><span class="line">sudo docker save -o ubuntu-test.tar test:latest</span><br><span class="line"></span><br><span class="line"><span class="comment">#载入镜像</span></span><br><span class="line">sudo docker <span class="built_in">load</span>  <span class="comment">--input ubuntu-test.tar</span></span><br><span class="line"><span class="operator">or</span></span><br><span class="line">sudo docker <span class="built_in">load</span> &lt; ubuntu-test.tar</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>3）使用Dockerfile创建镜像<br>Dockerfile是一个文本格式的配置文件，用户可以使用Dockerfile来快速创建镜像。</p>
<h2 id="容器">容器</h2><p>容器与虚拟机一样也是隔离的，它们都拥有这一个唯一标识自己的ID和名字。容器需要对外提供服务，所以Docker允许容器公开容器的特定端口。</p>
<p><img src="http://wenku.baidu.com/content/d817967416fc700abb68fca1?m=53edf76e3be441c342485c83deb30a3d&amp;type=pic&amp;src=766c4dab3fb9cf4d1b93c27911a87fcd.png" alt="Docker容器"></p>
<ul>
<li>创建容器<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">monkee@ubuntu:~$ sudo docker <span class="operator"><span class="keyword">create</span> -it <span class="keyword">test</span>:latest</span><br><span class="line">[sudo] <span class="keyword">password</span> <span class="keyword">for</span> monkee: </span><br><span class="line"><span class="number">20</span>eaf1df8114e74bd93dac72d4abcd34ccf07f68887c1e20f9bf4d417ce6f769</span><br><span class="line">monkee@ubuntu:~$ sudo docker ps -a</span><br><span class="line"><span class="keyword">CONTAINER</span> <span class="keyword">ID</span>        IMAGE               COMMAND             CREATED             <span class="keyword">STATUS</span>                   PORTS               <span class="keyword">NAMES</span></span><br><span class="line"><span class="number">20</span>eaf1df8114        <span class="keyword">test</span>:latest         <span class="string">"/bin/bash"</span>         <span class="number">23</span> seconds ago      Created                                      amazing_engelbart</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>对于终止状态的容器，可以通过命令<code>sudo docker ps -a -q</code>命令查看<br>通过<code>sudo docker start 20e</code>来启动上述新建的容器；<br>通过<code>sudo docker stop 20e</code>来终止上述新建的容器。</p>
<ul>
<li>新建并启动容器<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#开启一个bash终端</span></span><br><span class="line">sudo docker -t -i unbuntu:<span class="number">14.04</span> /bin/bash</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>其中</p>
<blockquote>
<p><code>-t</code> 选项是让Docker分配一个伪终端<br><code>-i</code>选项是让容器的标准输入保持打开<br>另外，<code>-d</code> 容器守护态运行</p>
</blockquote>
<ul>
<li>进入容器<br>对于使用<code>-d</code>选项进入后台运行的容器，有时需要进入容器进行操作。</li>
</ul>
<p>1）使用attack命令<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker ps</span><br><span class="line"><span class="constant">CONTAINER ID </span>       <span class="constant">IMAGE </span>              <span class="constant">COMMAND </span>            <span class="constant">CREATED </span>            <span class="constant">STATUS </span>             <span class="constant">PORTS </span>              <span class="constant">NAMES</span></span><br><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker run -idt <span class="symbol">test:</span>latest</span><br><span class="line">aabf150e0fb3900f0e1854a83a9c92375275f3e24c026315926b580a7ffe5568</span><br><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker ps</span><br><span class="line"><span class="constant">CONTAINER ID </span>       <span class="constant">IMAGE </span>              <span class="constant">COMMAND </span>            <span class="constant">CREATED </span>            <span class="constant">STATUS </span>             <span class="constant">PORTS </span>              <span class="constant">NAMES</span></span><br><span class="line">aabf150e0fb3        <span class="symbol">test:</span>latest         <span class="string">"/bin/bash"</span>         <span class="number">8</span> seconds ago       <span class="constant">Up </span><span class="number">6</span> seconds                            compassionate_jones</span><br><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker attach compassionate_jones</span><br><span class="line">root<span class="variable">@aabf150e0fb3</span><span class="symbol">:/</span><span class="comment">#</span></span><br></pre></td></tr></table></figure></p>
<p>2）使用exec命令<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker ps </span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">monkee:</span> </span><br><span class="line"><span class="constant">CONTAINER ID </span>       <span class="constant">IMAGE </span>              <span class="constant">COMMAND </span>            <span class="constant">CREATED </span>            <span class="constant">STATUS </span>             <span class="constant">PORTS </span>              <span class="constant">NAMES</span></span><br><span class="line"><span class="number">670</span>f5153659c        <span class="symbol">test:</span>latest         <span class="string">"/bin/bash"</span>         <span class="number">13</span> hours ago        <span class="constant">Up </span><span class="number">13</span> hours                             happy_hawking</span><br><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker exec -ti happy_hawking /bin/bash</span><br><span class="line">root<span class="variable">@670f5153659c</span><span class="symbol">:/</span><span class="comment">#</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>删除容器<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sudo</span> docker rm<span class="sqbracket"> [container id]</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker ps <span class="operator">-a</span> <span class="comment">#查看本机存在的所有容器</span></span><br></pre></td></tr></table></figure>
<h2 id="仓库">仓库</h2><p>仓库分私有仓库和公共仓库，Docker官方提供并维护了一个公共仓库：<a href="https://hub.docker.com/" target="_blank" rel="external">https://hub.docker.com/</a></p>
<p>Docker Pool是国内专业的Docker技术社区，也提供镜像下载服务。</p>
<p>对于私有仓库，可以通过该Docker提供的registry镜像来搭建简单的私有仓库。</p>
<h2 id="数据">数据</h2><p>容器中的数据一般需要备份、恢复操作，容器和主机以及容器和容器之间需要进行数据交互。<br>容器中管理数据有两种方式：</p>
<blockquote>
<ul>
<li>数据卷（Data Volumes）</li>
<li>数据卷容器（Data Volume Containers）</li>
</ul>
</blockquote>
<h3 id="数据卷">数据卷</h3><p>数据卷是一个可提供容器使用的特殊目录，其保存在运行Docker的宿主机的文件系统上。<br>数据卷的使用相当于Linux下的<code>mount</code>。</p>
<ul>
<li>创建一个数据卷<br>在<code>docker run</code>命令后加<code>-v</code>选项可以创建一个数据卷，多次使用<code>-v</code>可以创建多个数据卷。</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用training/webapp镜像创建一个容器，并在容器内/webapp目录下创建一个数据卷</span></span><br><span class="line">sudo docker <span class="command">run</span> -d -P <span class="comment">--name web -v /webapp training/webapp python app.py </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#挂载一个主机目录最为数据卷,例如将主机的/src/webapp目录挂载到容器的/opt/webapp,目录默认可读写</span></span><br><span class="line">sudo docker <span class="command">run</span> -d -P <span class="comment">--name web -v /src/webapp:/opt/webapp training/webapp python app.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#目录的权限也可以设定为只读</span></span><br><span class="line">sudo docker <span class="command">run</span> -d -P <span class="comment">--name web -v /src/webapp:/opt/webapp:ro training/webapp python app.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#也可以挂载一个主机文件作为数据卷</span></span><br></pre></td></tr></table></figure>
<p><code>-P</code>选项是运行外部访问容器提供的服务端口</p>
<h3 id="数据卷容器">数据卷容器</h3><p>数据卷容器其实就是一个专门提供数据卷的普通容器。一般应用于容器之间共享持续更新的数据的情景。</p>
<p>创建一个名为<code>dbdata</code>的数据卷容器,并挂载到<code>/dbdata</code>上<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker <span class="command">run</span> -<span class="keyword">it</span> -v /dbdata <span class="comment">--name dbdata ubuntu</span></span><br></pre></td></tr></table></figure></p>
<p>创建容器并使用<code>--volumes-from</code>来挂载dbdata容器中的数据卷<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker <span class="command">run</span> -<span class="keyword">it</span> <span class="comment">--volumes-from dbdata --name db1 ubuntu</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建数据卷容器dbdata</span></span><br><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker run -i -t -v /dbdata --name dbdata <span class="symbol">ubuntu:</span><span class="number">14.04</span></span><br><span class="line">root<span class="variable">@03dc8fef808f</span><span class="symbol">:/</span><span class="comment"># ls</span></span><br><span class="line">bin   dbdata  etc   lib    media  opt   root  sbin  sys  usr</span><br><span class="line">boot  dev     home  lib64  mnt    proc  run   srv   tmp  var</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建db1容器，并挂载dbdata容器</span></span><br><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker run -it --volumes-from dbdata --name db1 <span class="symbol">ubuntu:</span><span class="number">14.04</span></span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">monkee:</span> </span><br><span class="line">root<span class="variable">@c20f50dc54fd</span><span class="symbol">:/</span><span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建db2容器，并挂载dbdata容器</span></span><br><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker run -it --volumes-from dbdata --name db2 <span class="symbol">ubuntu:</span><span class="number">14.04</span></span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">monkee:</span> </span><br><span class="line">root<span class="variable">@a71fc85d1451</span><span class="symbol">:/</span><span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在容器db1中的/dbdata目录创建test文件</span></span><br><span class="line">root<span class="variable">@c20f50dc54fd</span><span class="symbol">:/</span><span class="comment"># touch /dbdata/test</span></span><br><span class="line">root<span class="variable">@c20f50dc54fd</span><span class="symbol">:/</span><span class="comment"># echo "test fun :)"&gt;/dbdata/test </span></span><br><span class="line">root<span class="variable">@c20f50dc54fd</span><span class="symbol">:/</span><span class="comment"># cat /dbdata/test </span></span><br><span class="line">test fun <span class="symbol">:</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#在容器db2和数据卷容器dbdata中可以查看到共享文件test</span></span><br><span class="line">root<span class="variable">@a71fc85d1451</span><span class="symbol">:/</span><span class="comment"># cat /dbdata/test </span></span><br><span class="line">test fun <span class="symbol">:</span>)</span><br><span class="line"></span><br><span class="line">root<span class="variable">@03dc8fef808f</span><span class="symbol">:/</span><span class="comment"># cat /dbdata/test </span></span><br><span class="line">test fun <span class="symbol">:</span>)</span><br></pre></td></tr></table></figure>
<p>多次使用<code>--volumes-from</code>可以从多个容器挂载多个数据卷，同时也可以从已挂载的容器挂载数据卷<br><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">monkee@ubuntu:~$ sudo docker run -it --volumes-<span class="keyword">from</span> db1 --name db3 ubuntu:<span class="number">14</span>.<span class="number">04</span>[sudo] password <span class="keyword">for</span> monkee: </span><br><span class="line">root@ae89fcba3b48:/<span class="comment"># ls</span></span><br><span class="line">bin   dbdata  etc   lib    media  opt   root  sbin  sys  usr</span><br><span class="line">boot  dev     home  lib64  mnt    <span class="keyword">proc</span>  run   srv   tmp  <span class="keyword">var</span></span><br><span class="line">root@ae89fcba3b48:/<span class="comment"># cat dbdata/test </span></span><br><span class="line">test fun :)</span><br></pre></td></tr></table></figure></p>
<h3 id="备份和恢复">备份和恢复</h3><p>备份操作如下<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">monkee<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="variable">$ </span>sudo docker run --volumes-from dbdata -v <span class="variable">$(</span>pwd)<span class="symbol">:/backup</span> --name worker <span class="symbol">ubuntu:</span><span class="number">14.04</span> tar cvf /backup/backup.tar /dbdata</span><br><span class="line"><span class="symbol">tar:</span> <span class="constant">Removing </span>leading `/<span class="string">' from member names</span><br><span class="line">/dbdata/</span><br><span class="line">/dbdata/test</span><br><span class="line">monkee@ubuntu:~$ ls</span><br><span class="line">backup.tar  Documents  examples.desktop  Pictures  Templates</span><br><span class="line">Desktop     Downloads  Music             Public    Videos</span></span><br></pre></td></tr></table></figure></p>
<p>恢复数据到一个容器如下<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#新建一个带有数据卷的容器</span></span><br><span class="line">sudo docker <span class="command">run</span> -v /dbdata <span class="comment">--name dbdata2 ubuntu /bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#再创建一个新容器，并挂载dbdata2</span></span><br><span class="line">sudo docker <span class="command">run</span> <span class="comment">--volumes-from dbdata2 -v $(pwd):/backup ubuntu tar xvf /backup/backup.tar</span></span><br></pre></td></tr></table></figure></p>
<h2 id="网络">网络</h2><p>没个容器拥有一个私有的IP。</p>
<ul>
<li>端口映射<br>为实现端口映射，需要在<code>docker run</code>命令后加选项<code>-p</code>或<code>-P</code>。<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -<span class="keyword">d</span> -<span class="keyword">p</span> localpor<span class="variable">t:containerport</span> ubuntu <span class="keyword">python</span> server.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>通过多次使用<code>-p</code>选项可以映射多个端口。<br>若要指定特定的IP地址<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -d -p <span class="string">ip:</span><span class="string">localport:</span>containerport ubuntu python server.py</span><br></pre></td></tr></table></figure></p>
<p>若localport缺省，则会映射到任意的本地端口。</p>
<p>查看映射端口<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">sudo</span> <span class="tag">docker</span> <span class="tag">port</span> <span class="attr_selector">[containerNAME]</span> <span class="attr_selector">[containerport]</span></span><br><span class="line"><span class="tag">or</span></span><br><span class="line"><span class="tag">sudo</span> <span class="tag">docker</span> <span class="tag">inspect</span> <span class="tag">containerID</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>容器间互联<br>容器的名称是唯一的，可以使用<code>--name</code>选项自定义。<br>使用<code>--link name:alias</code>选项实现容器间互联,其中name为链接容器的名字，alias为这个链接的别名<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先新建一个容器</span></span><br><span class="line">sudo docker <span class="command">run</span> -d <span class="comment">--name db Ubuntu</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#然后再创建一个关联的容器</span></span><br><span class="line">sudo docker <span class="command">run</span> -d -P <span class="comment">--name web --link db:webdb Ubuntu python sever.py</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>这样web容器就可以直接访问db容器了。如<code>ping db</code>。</p>
<blockquote>
<p>关于Docker的原理剖析后续再接上：)</p>
</blockquote>
<hr>
<h2 id="参考">参考</h2><ul>
<li><a href="http://dockerpool.com/static/books/docker_practice/index.html" target="_blank" rel="external">Docker技术入门与实践</a></li>
<li><a href="http://yuedu.baidu.com/ebook/d817967416fc700abb68fca1?fr=aladdin&amp;key=docker%E5%85%A5%E9%97%A8%E5%AE%9E%E6%88%98&amp;f=read" target="_blank" rel="external">Docker入门到实践</a></li>
<li><a href="https://hub.docker.com" target="_blank" rel="external">Dokcer Hub</a></li>
<li><a href="http://dockerpool.com/" target="_blank" rel="external">Docker Pool</a></li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Docker/">Docker</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://m0nkee.github.io/2015/11/30/about-docker/" data-title="about-docker | Monkee" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2015/11/26/about-git/"  title="Git小记">
 <strong>下一篇：</strong><br/> 
 <span>Git小记
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2015/11/30/about-docker/" data-title="about-docker" data-url="http://m0nkee.github.io/2015/11/30/about-docker/"></div>

</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker简介"><span class="toc-number">1.</span> <span class="toc-text">Docker简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker安装"><span class="toc-number">2.</span> <span class="toc-text">Docker安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#镜像"><span class="toc-number">3.</span> <span class="toc-text">镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#容器"><span class="toc-number">4.</span> <span class="toc-text">容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#仓库"><span class="toc-number">5.</span> <span class="toc-text">仓库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据"><span class="toc-number">6.</span> <span class="toc-text">数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷"><span class="toc-number">6.1.</span> <span class="toc-text">数据卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷容器"><span class="toc-number">6.2.</span> <span class="toc-text">数据卷容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#备份和恢复"><span class="toc-number">6.3.</span> <span class="toc-text">备份和恢复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网络"><span class="toc-number">7.</span> <span class="toc-text">网络</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">8.</span> <span class="toc-text">参考</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/dynamic-programming/" title="dynamic_programming">dynamic_programming<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Hacking-Linux/" title="Hacking_Linux">Hacking_Linux<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/数据结构/" title="数据结构">数据结构<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/c-c/" title="c/c++">c/c++<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/git/" title="git">git<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Docker/" title="Docker">Docker<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://monkee.esy.es" target="_blank" title="雷鸣之">雷鸣之</a>
            
          </li>
        
          <li>
            
            	<a href="http://coolshell.cn/" target="_blank" title="酷壳">酷壳</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Monkee Lei <br/>
			Stay Hungry Stay Foolish.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/m0nkee" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/m0nkee" target="_blank" class="icon-github" title="github"></a>
		
		
		
		<a href="https://twitter.com/monkee_lei" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/MonkeeLei" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2015 
		
		<a href="/about" target="_blank" title="Monkee Lei">Monkee Lei</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"m0nkee"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<script>
var option = {
  engineKey: 'f0db9047b73f62ca1d60'
};
(function(w,d,t,u,n,s,e){
  s = d.createElement(t);
  s.src = u;
  s.async = 1;
  w[n] = function(r){
    w[n].opts = r;
  };
  e = d.getElementsByTagName(t)[0];
  e.parentNode.insertBefore(s, e);
})(window,document,'script','//tinysou-cdn.b0.upaiyun.com/ts.js','_ts');
_ts(option);
</script>

<!-- Tiny_search End -->

  </body>
</html>
